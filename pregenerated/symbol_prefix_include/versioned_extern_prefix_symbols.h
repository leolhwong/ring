// Copyright (c) 2018, Google Inc.
//
// Permission to use, copy, modify, and/or distribute this software for any
// purpose with or without fee is hereby granted, provided that the above
// copyright notice and this permission notice appear in all copies.
//
// THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
// WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
// MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
// SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
// WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
// OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
// CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

// ADD_VERSIONED_EXTERN_PREFIX pastes two identifiers into one. It performs one
// iteration of macro expansion on its arguments before pasting.
#define ADD_VERSIONED_EXTERN_PREFIX(a, b) ADD_VERSIONED_EXTERN_PREFIX_INNER(a, b)
#define ADD_VERSIONED_EXTERN_PREFIX_INNER(a, b) a ## _ ## b

#define GFp_ChaCha20_ctr32 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_ChaCha20_ctr32)
#define GFp_aes_hw_ctr32_encrypt_blocks ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aes_hw_ctr32_encrypt_blocks)
#define GFp_aes_hw_encrypt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aes_hw_encrypt)
#define GFp_aes_hw_set_encrypt_key ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aes_hw_set_encrypt_key)
#define GFp_aes_nohw_encrypt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aes_nohw_encrypt)
#define GFp_aes_nohw_set_encrypt_key ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aes_nohw_set_encrypt_key)
#define GFp_aesni_gcm_decrypt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aesni_gcm_decrypt)
#define GFp_aesni_gcm_encrypt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_aesni_gcm_encrypt)
#define GFp_bn_from_montgomery ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_from_montgomery)
#define GFp_bn_from_montgomery_in_place ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_from_montgomery_in_place)
#define GFp_bn_gather5 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_gather5)
#define GFp_bn_mul_add_words ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_mul_add_words)
#define GFp_bn_mul_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_mul_mont)
#define GFp_bn_mul_mont_gather5 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_mul_mont_gather5)
#define GFp_bn_neg_inv_mod_r_u64 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_neg_inv_mod_r_u64)
#define GFp_bn_power5 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_power5)
#define GFp_bn_scatter5 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_scatter5)
#define GFp_bn_sqr8x_internal ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_sqr8x_internal)
#define GFp_bn_sqrx8x_internal ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_bn_sqrx8x_internal)
#define GFp_cpuid_setup ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_cpuid_setup)
#define GFp_gcm_ghash_4bit ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_ghash_4bit)
#define GFp_gcm_ghash_avx ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_ghash_avx)
#define GFp_gcm_ghash_clmul ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_ghash_clmul)
#define GFp_gcm_gmult_4bit ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_gmult_4bit)
#define GFp_gcm_gmult_clmul ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_gmult_clmul)
#define GFp_gcm_init_4bit ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_init_4bit)
#define GFp_gcm_init_avx ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_init_avx)
#define GFp_gcm_init_clmul ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_gcm_init_clmul)
#define GFp_ia32cap_P ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_ia32cap_P)
#define GFp_memcmp ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_memcmp)
#define GFp_nistz256_add ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_add)
#define GFp_nistz256_avx2_select_w7 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_avx2_select_w7)
#define GFp_nistz256_mul_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_mul_mont)
#define GFp_nistz256_neg ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_neg)
#define GFp_nistz256_point_add ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_point_add)
#define GFp_nistz256_point_add_affine ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_point_add_affine)
#define GFp_nistz256_point_double ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_point_double)
#define GFp_nistz256_point_mul ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_point_mul)
#define GFp_nistz256_point_mul_base ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_point_mul_base)
#define GFp_nistz256_select_w5 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_select_w5)
#define GFp_nistz256_select_w7 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_select_w7)
#define GFp_nistz256_sqr_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz256_sqr_mont)
#define GFp_nistz384_point_add ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz384_point_add)
#define GFp_nistz384_point_double ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz384_point_double)
#define GFp_nistz384_point_mul ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_nistz384_point_mul)
#define GFp_p256_scalar_mul_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p256_scalar_mul_mont)
#define GFp_p256_scalar_sqr_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p256_scalar_sqr_mont)
#define GFp_p256_scalar_sqr_rep_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p256_scalar_sqr_rep_mont)
#define GFp_p384_elem_add ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_elem_add)
#define GFp_p384_elem_div_by_2 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_elem_div_by_2)
#define GFp_p384_elem_mul_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_elem_mul_mont)
#define GFp_p384_elem_neg ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_elem_neg)
#define GFp_p384_elem_sub ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_elem_sub)
#define GFp_p384_scalar_mul_mont ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_p384_scalar_mul_mont)
#define GFp_poly1305_blocks ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_poly1305_blocks)
#define GFp_poly1305_emit ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_poly1305_emit)
#define GFp_poly1305_init_asm ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_poly1305_init_asm)
#define GFp_sha256_block_data_order ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_sha256_block_data_order)
#define GFp_sha512_block_data_order ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_sha512_block_data_order)
#define GFp_vpaes_encrypt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_vpaes_encrypt)
#define GFp_vpaes_set_encrypt_key ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_vpaes_set_encrypt_key)
#define GFp_x25519_fe_invert ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_fe_invert)
#define GFp_x25519_fe_isnegative ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_fe_isnegative)
#define GFp_x25519_fe_mul_ttt ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_fe_mul_ttt)
#define GFp_x25519_fe_neg ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_fe_neg)
#define GFp_x25519_fe_tobytes ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_fe_tobytes)
#define GFp_x25519_ge_double_scalarmult_vartime ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_ge_double_scalarmult_vartime)
#define GFp_x25519_ge_frombytes_vartime ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_ge_frombytes_vartime)
#define GFp_x25519_ge_scalarmult_base ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_ge_scalarmult_base)
#define GFp_x25519_public_from_private_generic_masked ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_public_from_private_generic_masked)
#define GFp_x25519_sc_mask ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_sc_mask)
#define GFp_x25519_sc_muladd ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_sc_muladd)
#define GFp_x25519_sc_reduce ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_sc_reduce)
#define GFp_x25519_scalar_mult_generic_masked ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, GFp_x25519_scalar_mult_generic_masked)
#define LIMBS_add_mod ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_add_mod)
#define LIMBS_are_even ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_are_even)
#define LIMBS_are_zero ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_are_zero)
#define LIMBS_copy ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_copy)
#define LIMBS_equal ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_equal)
#define LIMBS_equal_limb ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_equal_limb)
#define LIMBS_less_than ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_less_than)
#define LIMBS_less_than_limb ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_less_than_limb)
#define LIMBS_reduce_once ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_reduce_once)
#define LIMBS_select_512_32 ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_select_512_32)
#define LIMBS_shl_mod ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_shl_mod)
#define LIMBS_sub_mod ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_sub_mod)
#define LIMBS_window5_split_window ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_window5_split_window)
#define LIMBS_window5_unsplit_window ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMBS_window5_unsplit_window)
#define LIMB_shr ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, LIMB_shr)
#define gfp_little_endian_bytes_from_scalar ADD_VERSIONED_EXTERN_PREFIX(VERSIONED_EXTERN_PREFIX, gfp_little_endian_bytes_from_scalar)
